extends ../../layout/default.pug

include ../../mixins/filterStatus.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
include ../../mixins/formChangeMulti.pug
include ../../mixins/showalert.pug

block main
    +alertSuccess(5000)
            
    h1 Danh sách sản phẩm
    .card.mb-3 
        .card-header
            h5.card-title Bộ lọc và tìm kiếm
        .card-body
            .row
                .col-6
                    +filterStatus(filterStatus)
                .col-6 
                    +search(keyword)
                            

    .card.mb-3
        .card-header
            .row
                .col-6 
                    h5.card-title Danh sách sản phẩm
                .col-6.text-end
                    a(
                        class="btn btn-sm btn-outline-success"
                        href=`${prefixAdmin}/products/create`
                    ) + Thêm sản phẩm
        .card-body
            +formChangeMulti(`${prefixAdmin}/products/change-multi?_method=PATCH`)                  
            .table-responsive
                table(
                    class="table table-hover table-sm"
                    checkbox-multi
                )
                    thead 
                        tr
                            th
                                input(type="checkbox" name="checkAll")
                            th STT
                            th Vị trí
                            th Hình ảnh
                            th Tên sản phẩm
                            th Giá
                            th Giảm giá
                            th Trạng thái
                            th Hành động
                    tbody
                        each item, index in products  
                            tr
                                td 
                                    input(
                                        type="checkbox" 
                                        name="checkItem" 
                                        value=item._id
                                    )
                                td #{index + 1}
                                td 
                                    input(
                                        type='number'
                                        value=item.position
                                        style='width: 50px'
                                        min='1'
                                        name='position'
                                    )
                                td 
                                    img.img-thumbnail(src=item.thumbnail, alt=item.title width="100px" height="auto")
                                td #{item.title}
                                td #{item.price} $
                                td #{item.discountPercentage} %
                                td
                                    if item.status == 'active'
                                        a(
                                            href=`javascript:`
                                            data-status=item.status
                                            data-id=item._id
                                            button-change-status
                                            class="badge bg-success"
                                        ) Hoạt động
                                    else
                                        a(
                                            href=`javascript:`
                                            data-id=item._id
                                            data-status=item.status
                                            button-change-status
                                            class="badge bg-danger" 
                                        ) Không hoạt động
                                td                                
                                    button(
                                    class=`btn btn-warning btn-sm margin-right: 8px`,
                                    style="margin-right: 8px"
                                    ) Sửa        
                                    button(
                                        class=`btn btn-danger btn-sm`
                                        data-id=item._id
                                        button-delete
                                    ) Xóa


    
    .row 
        .col-6
            +pagination(pagination)
        .col-6.text-end
            a.btn.btn-primary(href=`${prefixAdmin}/products/trash`) Thùng rác

    //- Form change status nhằm thay đổi trạng thái của sản phẩm
    form(
        action=""
        method="POST" 
        id="form-change-status"
        data-path=`${prefixAdmin}/products/change-status`
    )

    form(
        action=""
        method="POST"
        id="form-delete"
        data-path=`${prefixAdmin}/products/delete`
    )




    script(src="/admin/js/productScripts.js") 

